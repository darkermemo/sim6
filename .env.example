# ===== SIEM System Environment Configuration Template =====
# Copy this file to .env and update the values for your environment
# This file serves as a template showing all available configuration options

# ===== Database Configuration =====
# ClickHouse Configuration
CLICKHOUSE_URL=http://localhost:8123
CLICKHOUSE_DATABASE=dev
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=
CLICKHOUSE_TCP_URL=tcp://localhost:9000/default

# PostgreSQL Configuration (for metadata)
DATABASE_URL=postgres://username:password@localhost:5432/database_name
POSTGRES_USER=username
POSTGRES_PASSWORD=password
POSTGRES_DB=database_name
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# ===== API Configuration =====
# Main API Server
API_URL=http://localhost:8080
API_PORT=8080
API_HOST=0.0.0.0

# Ingestor Service
INGESTOR_URL=http://localhost:8081
INGESTOR_PORT=8081
INGESTOR_HOST=0.0.0.0

# ===== Authentication & Security =====
# JWT Configuration - CHANGE THESE IN PRODUCTION!
# Use a strong 64+ character secret for production
JWT_SECRET=your-super-secret-jwt-key-here-change-this-in-production
# Set to 0 for permanent tokens (never expire)
JWT_EXPIRATION_HOURS=0
# JWT Issuer and Audience for validation
JWT_ISSUER=siem-auth
JWT_AUDIENCE=siem-search

# Admin Token Configuration - CHANGE THESE IN PRODUCTION!
ADMIN_TOKEN=admin-token-12345-change-in-production
ADMIN_TOKEN_DURATION_HOURS=1

# Agent API Key - CHANGE THIS IN PRODUCTION!
AGENT_API_KEY=agent-api-key-12345-change-in-production

# ===== Kafka Configuration =====
# Kafka Brokers
KAFKA_BROKERS=localhost:9092
KAFKA_BOOTSTRAP_SERVERS=localhost:9092

# Kafka Topics
KAFKA_EVENTS_TOPIC=siem_events
KAFKA_ALERTS_TOPIC=siem_alerts
KAFKA_LOGS_TOPIC=siem_logs

# Kafka Consumer Groups
KAFKA_CONSUMER_GROUP=siem_clickhouse_writer
KAFKA_CONSUMER_GROUP_ALERTS=siem_alert_processor

# Kafka Configuration
KAFKA_PARTITIONS_EVENTS=6
KAFKA_PARTITIONS_ALERTS=3
KAFKA_REPLICATION_FACTOR=1
KAFKA_MIN_INSYNC_REPLICAS=1

# ===== Service Ports =====
# UI Development Server
VITE_PORT=3001
VITE_API_BASE=http://localhost:8080
VITE_DEMO_REFRESH_TOKEN=demo-refresh-token

# Monitoring Ports
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
NODE_EXPORTER_PORT=9100

# ===== Data Pruner Configuration =====
CHECK_INTERVAL_HOURS=24
DRY_RUN=false

# ===== Logging Configuration =====
RUST_LOG=info
LOG_LEVEL=info

# ===== Development/Testing Configuration =====
# Environment Mode
ENVIRONMENT=development
DEBUG=true

# Test Configuration
TEST_DATABASE_URL=postgres://username:password@localhost:5432/test_database
TEST_CLICKHOUSE_URL=http://localhost:8123

# ===== Health Check Configuration =====
HEALTH_CHECK_TIMEOUT=30
HEALTH_CHECK_RETRIES=30
HEALTH_CHECK_INTERVAL=10

# ===== Performance Configuration =====
MIN_API_RESPONSE_TIME_MS=500
MIN_THROUGHPUT_EVENTS_PER_SEC=1000

# ===== Backup Configuration =====
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE=0 2 * * *
BACKUP_STORAGE_PATH=/opt/siem/backups

# ===== Container Configuration =====
# CONTAINER_REGISTRY=docker.io  # Removed - Docker-free deployment
CONTAINER_REPOSITORY=company/siem
SIEM_API_VERSION=latest
SIEM_INGESTOR_VERSION=latest
SIEM_CONSUMER_VERSION=latest
SIEM_RULE_ENGINE_VERSION=latest

# ===== ClickHouse Cluster Configuration =====
CLICKHOUSE_VERSION=23.3
CLICKHOUSE_REPLICATION_FACTOR=1
CLICKHOUSE_SHARD_COUNT=1

# ===== Recovery Configuration =====
INFRASTRUCTURE_PROVISION_TIMEOUT=3600
SOFTWARE_INSTALL_TIMEOUT=1800
BACKUP_RESTORE_TIMEOUT=7200
SERVICE_DEPLOY_TIMEOUT=1800
VERIFICATION_TIMEOUT=900
MAX_RETRIES=3
RETRY_DELAY=60

# ===== Network Configuration =====
# External IPs (update these for your environment)
CLICKHOUSE_EXTERNAL_IP=127.0.0.1
KAFKA_EXTERNAL_IP=127.0.0.1
API_EXTERNAL_IP=127.0.0.1
INGESTOR_EXTERNAL_IP=127.0.0.1

# ===== SSL/TLS Configuration =====
# Set to true for production
ENABLE_TLS=false
SSL_CERT_PATH=/opt/siem/certs/server.crt
SSL_KEY_PATH=/opt/siem/certs/server.key

# ===== CORS Configuration =====
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization

# ===== Rate Limiting =====
RATE_LIMIT_REQUESTS_PER_MINUTE=1000
RATE_LIMIT_BURST_SIZE=100

# ===== Session Configuration =====
# CHANGE THIS IN PRODUCTION!
SESSION_SECRET=your-session-secret-change-in-production
SESSION_TIMEOUT_MINUTES=60

# ===== File Upload Configuration =====
MAX_FILE_SIZE_MB=100
UPLOAD_PATH=/tmp/siem_uploads

# ===== Cache Configuration =====
REDIS_URL=redis://localhost:6379
CACHE_TTL_SECONDS=3600

# ===== Notification Configuration =====
# Email Configuration (optional)
SMTP_HOST=localhost
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@siem.local

# Webhook Configuration (optional)
WEBHOOK_URL=
WEBHOOK_SECRET=

# ===== Threat Intelligence Configuration =====
THREAT_INTEL_API_KEY=
THREAT_INTEL_UPDATE_INTERVAL_HOURS=24

# ===== UEBA Configuration =====
UEBA_MODEL_UPDATE_INTERVAL_HOURS=168
UEBA_ANOMALY_THRESHOLD=0.8

# ===== Agent Configuration =====
AGENT_HEARTBEAT_INTERVAL_SECONDS=30
AGENT_CONFIG_UPDATE_INTERVAL_SECONDS=300

# ===== Retention Policy =====
DEFAULT_RETENTION_DAYS=90
ALERT_RETENTION_DAYS=365
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years

# ===== IMPORTANT SECURITY NOTES =====
# 1. Change all default passwords and secrets before deploying to production
# 2. Use strong, randomly generated values for JWT_SECRET, ADMIN_TOKEN, etc.
# 3. Enable TLS (ENABLE_TLS=true) in production environments
# 4. Restrict CORS_ALLOWED_ORIGINS to your actual domain(s) in production
# 5. Use environment-specific database credentials
# 6. Consider using a secrets management system for sensitive values