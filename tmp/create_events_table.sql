CREATE TABLE dev.events
(
    `event_id` String,
    `tenant_id` String,
    `event_timestamp` UInt32,
    `source_ip` String,
    `source_type` String,
    `raw_event` String,
    `event_category` String,
    `event_outcome` String,
    `event_action` String,
    `log_source_id` Nullable(String),
    `parsing_status` Nullable(String),
    `parse_error_msg` Nullable(String),
    `dest_ip` Nullable(String),
    `src_port` Nullable(UInt16),
    `dest_port` Nullable(UInt16),
    `protocol` Nullable(String),
    `bytes_in` Nullable(UInt64),
    `bytes_out` Nullable(UInt64),
    `packets_in` Nullable(UInt64),
    `packets_out` Nullable(UInt64),
    `duration` Nullable(UInt32),
    `user_name` Nullable(String),
    `user_domain` Nullable(String),
    `user_id` Nullable(String),
    `process_name` Nullable(String),
    `process_id` Nullable(UInt32),
    `parent_process_name` Nullable(String),
    `parent_process_id` Nullable(UInt32),
    `file_path` Nullable(String),
    `file_name` Nullable(String),
    `file_size` Nullable(UInt64),
    `command_line` Nullable(String),
    `registry_key` Nullable(String),
    `registry_value` Nullable(String),
    `url` Nullable(String),
    `uri_path` Nullable(String),
    `uri_query` Nullable(String),
    `http_method` Nullable(String),
    `http_status_code` Nullable(UInt16),
    `http_user_agent` Nullable(String),
    `http_referrer` Nullable(String),
    `http_content_type` Nullable(String),
    `http_content_length` Nullable(UInt64),
    `src_host` Nullable(String),
    `dest_host` Nullable(String),
    `device_type` Nullable(String),
    `vendor` Nullable(String),
    `product` Nullable(String),
    `version` Nullable(String),
    `src_country` Nullable(String),
    `dest_country` Nullable(String),
    `src_zone` Nullable(String),
    `dest_zone` Nullable(String),
    `interface_in` Nullable(String),
    `interface_out` Nullable(String),
    `vlan_id` Nullable(UInt16),
    `rule_id` Nullable(String),
    `rule_name` Nullable(String),
    `policy_id` Nullable(String),
    `policy_name` Nullable(String),
    `signature_id` Nullable(String),
    `signature_name` Nullable(String),
    `threat_name` Nullable(String),
    `threat_category` Nullable(String),
    `severity` Nullable(String),
    `priority` Nullable(String),
    `auth_method` Nullable(String),
    `auth_app` Nullable(String),
    `failure_reason` Nullable(String),
    `session_id` Nullable(String),
    `app_name` Nullable(String),
    `app_category` Nullable(String),
    `service_name` Nullable(String),
    `email_sender` Nullable(String),
    `email_recipient` Nullable(String),
    `email_subject` Nullable(String),
    `tags` Nullable(String),
    `message` Nullable(String),
    `details` Nullable(String),
    `custom_fields` Map(String, String),
    `ingestion_timestamp` UInt32 DEFAULT 0
)
ENGINE = MergeTree
ORDER BY (tenant_id, event_timestamp)
SETTINGS index_granularity = 8192