[server]
host = "127.0.0.1"
port = 8080
workers = 4
max_connections = 1000
request_timeout = 30
enable_cors = true

# Database Configuration
[database]
host = "localhost"
port = 5432
database = "siem"
username = "siem_user"
password = "siem_password"
max_connections = 20
min_connections = 5
connection_timeout = 30
idle_timeout = 600
max_lifetime = 3600

# Data Sources Configuration
[sources.syslog_source]
source_type = { type = "Syslog", port = 514, protocol = "udp" }
enabled = true
batch_size = 1000
buffer_size = 10000
retry_attempts = 3
retry_delay = 1000

[sources.syslog_source.config]
format = "Syslog"
encoding = "utf-8"
fields = {}

# Transformations Configuration
[transformations.basic_transform]
parallel = false
error_handling = "Continue"

[[transformations.basic_transform.steps]]
type = "Parse"
parser = "json"
config = {}

# Storage Configuration
[storage]

[storage.data_lake]
provider = "minio"
bucket = "siem-data-lake"
region = "us-east-1"
access_key = "minioadmin"
secret_key = "minioadmin"
endpoint = "http://localhost:9000"

[storage.hot_storage]
clickhouse_url = "tcp://localhost:9000/default"
database = "siem"
retention_days = 30

[storage.cold_storage]
s3_bucket = "siem-cold-storage"
compression = "Zstd"
format = "Parquet"
s3_region = "us-east-1"
s3_access_key = "minioadmin"
s3_secret_key = "minioadmin"

[storage.retention]
hot_days = 7
warm_days = 30
cold_days = 365
delete_after_days = 2555
retention_days = 365

[security]
# TLS configuration (optional)
# [security.tls]
# cert_file = "/path/to/cert.pem"
# key_file = "/path/to/key.pem"
# ca_file = "/path/to/ca.pem"

# Authentication configuration (optional)
# [security.authentication]
# method = "ApiKey"
# [security.authentication.config]
# api_key = "your-api-key"

# Rate limiting configuration (optional)
# [security.rate_limiting]
# requests_per_second = 1000
# burst_size = 100
# window_seconds = 60

[routing]
default_destination = "redis_cache"
load_balancing = "RoundRobin"

[[routing.rules]]
name = "all_events"
condition = "true"
destinations = ["redis_cache"]
priority = 1
enabled = true

[destinations.redis_cache]
enabled = true
destination_type = { type = "Redis", connection_string = "redis://localhost:6379/0", key_pattern = "siem:events:{timestamp}:{source}", ttl = 3600 }
config = { format = "Json", compression = "Gzip" }
batch_size = 1000
flush_interval = 5000
retry_attempts = 3



[metrics]
enabled = true
port = 9090
path = "/metrics"
labels = {}

[performance]
[performance.workers]
ingestion_workers = 4
transformation_workers = 8
routing_workers = 4
storage_workers = 8

[performance.buffers]
event_buffer_size = 100000
batch_buffer_size = 10000
flush_interval_ms = 1000

[performance.memory]
max_memory_usage = "8GB"
gc_threshold = "6GB"

[performance.parallel_processing]
enabled = false
worker_count = 4
batch_size = 1000
batch_timeout_ms = 100

[rate_limiting]
enabled = true
requests_per_second = 1000
burst_size = 5000