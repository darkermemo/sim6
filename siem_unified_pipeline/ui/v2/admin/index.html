<!doctype html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="stylesheet" href="./_shared.css"/>
<title>Admin Â· SIEM</title>
</head><body>
<header>
  <div class="title">SIEM Admin</div>
  <nav aria-label="Admin">
    <a href="./tenants.html">Tenants</a>
    <a href="./log-sources.html">Log Sources</a>
    <a href="./parsers.html">Parsers</a>
    <a href="./cim.html">CIM Explorer</a>
    <a href="./sigma.html">Sigma</a>
    <a href="./ingestors.html">Ingestors</a>
  </nav>
  <div style="margin-left:auto" class="small">BASE_URL:
    <input id="baseUrl" style="width:280px" placeholder="e.g. http://127.0.0.1:9999"/></div>
</header>
<main>
  <div class="card">
    <h3>Welcome</h3>
    <p>Use the navigation to configure tenants, manage log sources & parsers, import Sigma, and observe ingestors.</p>
  </div>
  <div class="card">
    <h3>System Config</h3>
    <div class="row">
      <button id="btn-load">Load</button>
      <button id="btn-save" class="primary">Save</button>
    </div>
    <textarea id="cfg" spellcheck="false" placeholder='{"feature_flags":{"sigma":"on"}}'></textarea>
  </div>
</main>
<div id="toast" class="toast" role="status" aria-live="polite"></div>
<script src="./_shared.js"></script>
<script>
  setCurrentNav('index.html');
  const inp = document.querySelector('#baseUrl'); inp.value = localStorage.getItem('BASE_URL') || BASE_URL;
  inp.addEventListener('change', ()=>{ localStorage.setItem('BASE_URL', inp.value.trim()); toast('Saved BASE_URL'); });
  document.querySelector('#btn-load').onclick = async ()=>{
    try{ const v = await api('/api/v2/admin/config'); document.querySelector('#cfg').value = JSON.stringify(v, null, 2); toast('Loaded','ok'); }catch(e){ toast(e.message,'error'); }
  };
  document.querySelector('#btn-save').onclick = async ()=>{
    try{ const body = JSON.parse(document.querySelector('#cfg').value||'{}'); await api('/api/v2/admin/config', {method:'PUT', body: JSON.stringify(body)}); toast('Saved','ok'); }catch(e){ toast(e.message,'error'); }
  };
</script>
</body></html>


